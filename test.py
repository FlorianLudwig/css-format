import sys
import re
from cssformat import CssFormatter, CssFormatOptions, word_wrap
from StringIO import StringIO
from scanner import Scanner

css = "/*******************************************************************************Slate Theme for Github Pagesby Jason Costello, @jsncostello*******************************************************************************/\nhtml, body, div, span, applet, object, iframe,\nh1, h2, h3, h4, h5, h6, p, blockquote, pre,\na, abbr, acronym, address, big, cite, code,\ndel, dfn, em, img, ins, kbd, q, s, samp,\nsmall, strike, strong, sub, sup, tt, var,\nb, u, i, center,\ndl, dt, dd, ol, ul, li,\nfieldset, form, label, legend,\ntable, caption, tbody, tfoot, thead, tr, th, td,\narticle, aside, canvas, details, embed,\nfigure, figcaption, footer, header, hgroup,\nmenu, nav, output, ruby, section, summary,\ntime, mark, audio, video {\n  margin: 0;\n  padding: 0;\n  border: 0;\n  font: inherit;\n  vertical-align: baseline;\n}\n\n/* HTML5 display-role reset for older browsers */\narticle, aside, details, figcaption, figure,\nfooter, header, hgroup, menu, nav, section {\n  display: block;\n}\n\nol, ul {\n  list-style: none;\n}\n\nblockquote, q {\n}\n\ntable {\n  border-collapse: collapse;\n  border-spacing: 0;\n}\n\na:focus {\n  outline: none;\n}\n\n/*******************************************************************************\nTheme Styles\n*******************************************************************************/\n\nbody {\n  box-sizing: border-box;\n  color:#373737;\n  background: #212121;\n  font-size: 16px;\n  font-family: 'Myriad Pro', Calibri, Helvetica, Arial, sans-serif;\n  line-height: 1.5;\n  -webkit-font-smoothing: antialiased;\n}\n\nh1, h2, h3, h4, h5, h6 {\n  margin: 10px 0;\n  font-weight: 700;\n  color:#222222;\n  font-family: 'Lucida Grande', 'Calibri', Helvetica, Arial, sans-serif;\n  letter-spacing: -1px;\n}\n\nh1 {\n  font-size: 36px;\n  font-weight: 700;\n}\n\nh2 {\n  padding-bottom: 10px;\n  font-size: 32px;\n  background: url('../images/bg_hr.png') repeat-x bottom;\n}\n\nh3 {\n  font-size: 24px;\n}\n\nh4 {\n  font-size: 21px;\n}\n\nh5 {\n  font-size: 18px;\n}\n\nh6 {\n  font-size: 16px;\n}\n\np {\n  margin: 10px 0 15px 0;\n}\n\nfooter p {\n  color: #f2f2f2;\n}\n\na {\n  text-decoration: none;\n  color: #007edf;\n  text-shadow: none;\n\n  transition: color 0.5s ease;\n  transition: text-shadow 0.5s ease;\n  -webkit-transition: color 0.5s ease;\n  -webkit-transition: text-shadow 0.5s ease;\n  -moz-transition: color 0.5s ease;\n  -moz-transition: text-shadow 0.5s ease;\n  -o-transition: color 0.5s ease;\n  -o-transition: text-shadow 0.5s ease;\n  -ms-transition: color 0.5s ease;\n  -ms-transition: text-shadow 0.5s ease;\n}\n\n#main_content a:hover {\n  color: #0069ba;\n  text-shadow: #0090ff 0px 0px 2px;\n}\n\nfooter a:hover {\n  color: #43adff;\n  text-shadow: #0090ff 0px 0px 2px;\n}\n\nem {\n  font-style: italic;\n}\n\nstrong {\n  font-weight: bold;\n}\n\nimg {\n  position: relative;\n  margin: 0 auto;\n  max-width: 739px;\n  padding: 5px;\n  margin: 10px 0 10px 0;\n  border: 1px solid #ebebeb;\n\n  box-shadow: 0 0 5px #ebebeb;\n  -webkit-box-shadow: 0 0 5px #ebebeb;\n  -moz-box-shadow: 0 0 5px #ebebeb;\n  -o-box-shadow: 0 0 5px #ebebeb;\n  -ms-box-shadow: 0 0 5px #ebebeb;\n}\n\npre, code {\n  width: 100%;\n  color: #222;\n  background-color: #fff;\n\n  font-family: Monaco, \"Bitstream Vera Sans Mono\", \"Lucida Console\", Terminal, monospace;\n  font-size: 14px;\n\n  border-radius: 2px;\n  -moz-border-radius: 2px;\n  -webkit-border-radius: 2px;\n\n\n\n}\n\npre {\n  width: 100%;\n  padding: 10px;\n  box-shadow: 0 0 10px rgba(0,0,0,.1);\n  overflow: auto;\n}\n\ncode {\n  padding: 3px;\n  margin: 0 3px;\n  box-shadow: 0 0 10px rgba(0,0,0,.1);\n}\n\npre code {\n  display: block;\n  box-shadow: none;\n}\n\nblockquote {\n  color: #666;\n  margin-bottom: 20px;\n  padding: 0 0 0 20px;\n  border-left: 3px solid #bbb;\n}\n\nul, ol, dl {\n  margin-bottom: 15px\n}\n\nul li {\n  list-style: inside;\n  padding-left: 20px;\n}\n\nol li {\n  list-style: decimal inside;\n  padding-left: 20px;\n}\n\ndl dt {\n  font-weight: bold;\n}\n\ndl dd {\n  padding-left: 20px;\n  font-style: italic;\n}\n\ndl p {\n  padding-left: 20px;\n  font-style: italic;\n}\n\nhr {\n  height: 1px;\n  margin-bottom: 5px;\n  border: none;\n  background: url('../images/bg_hr.png') repeat-x center;\n}\n\ntable {\n  border: 1px solid #373737;\n  margin-bottom: 20px;\n  text-align: left;\n }\n\nth {\n  font-family: 'Lucida Grande', 'Helvetica Neue', Helvetica, Arial, sans-serif;\n  padding: 10px;\n  background: #373737;\n  color: #fff;\n }\n\ntd {\n  padding: 10px;\n  border: 1px solid #373737;\n }\n\nform {\n  background: #f2f2f2;\n  padding: 20px;\n}\n\nimg {\n  width: 100%;\n  max-width: 100%;\n}\n\n/*******************************************************************************\nFull-Width Styles\n*******************************************************************************/\n\n.outer {\n  width: 100%;\n}\n\n.inner {\n  position: relative;\n  max-width: 640px;\n  padding: 20px 10px;\n  margin: 0 auto;\n}\n\n#forkme_banner {\n  display: block;\n  position: absolute;\n  top:0;\n  right: 10px;\n  z-index: 10;\n  padding: 10px 50px 10px 10px;\n  color: #fff;\n  background: url('../images/blacktocat.png') #0090ff no-repeat 95% 50%;\n  font-weight: 700;\n  box-shadow: 0 0 10px rgba(0,0,0,.5);\n  border-bottom-left-radius: 2px;\n  border-bottom-right-radius: 2px;\n}\n\n#header_wrap {\n  background: #212121;\n  background: -moz-linear-gradient(top, #373737, #212121);\n  background: -webkit-linear-gradient(top, #373737, #212121);\n  background: -ms-linear-gradient(top, #373737, #212121);\n  background: -o-linear-gradient(top, #373737, #212121);\n  background: linear-gradient(top, #373737, #212121);\n}\n\n#header_wrap .inner {\n  padding: 50px 10px 30px 10px;\n}\n\n#project_title {\n  margin: 0;\n  color: #fff;\n  font-size: 42px;\n  font-weight: 700;\n  text-shadow: #111 0px 0px 10px;\n}\n\n#project_tagline {\n  color: #fff;\n  font-size: 24px;\n  font-weight: 300;\n  background: none;\n  text-shadow: #111 0px 0px 10px;\n}\n\n#downloads {\n  position: absolute;\n  width: 210px;\n  z-index: 10;\n  bottom: -40px;\n  right: 0;\n  height: 70px;\n  background: url('../images/icon_download.png') no-repeat 0% 90%;\n}\n\n.zip_download_link {\n  display: block;\n  float: right;\n  width: 90px;\n  height:70px;\n  text-indent: -5000px;\n  overflow: hidden;\n  background: url(../images/sprite_download.png) no-repeat bottom left;\n}\n\n.tar_download_link {\n  display: block;\n  float: right;\n  width: 90px;\n  height:70px;\n  text-indent: -5000px;\n  overflow: hidden;\n  background: url(../images/sprite_download.png) no-repeat bottom right;\n  margin-left: 10px;\n}\n\n.zip_download_link:hover {\n  background: url(../images/sprite_download.png) no-repeat top left;\n}\n\n.tar_download_link:hover {\n  background: url(../images/sprite_download.png) no-repeat top right;\n}\n\n#main_content_wrap {\n  background: #f2f2f2;\n  border-top: 1px solid #111;\n  border-bottom: 1px solid #111;\n}\n\n#main_content {\n  padding-top: 40px;\n}\n\n#footer_wrap {\n  background: #212121;\n}\n\n\n\n/*******************************************************************************\nSmall Device Styles\n*******************************************************************************/\n\n@media screen and (max-width: 480px) {\n  body {\n    font-size:14px;\n  }\n\n  #downloads {\n    display: none;\n  }\n\n  .inner {\n    min-width: 320px;\n    max-width: 480px;\n  }\n\n  #project_title {\n  font-size: 32px;\n  }\n\n  h1 {\n    font-size: 28px;\n  }\n\n  h2 {\n    font-size: 24px;\n  }\n\n  h3 {\n    font-size: 21px;\n  }\n\n  h4 {\n    font-size: 18px;\n  }\n\n  h5 {\n    font-size: 14px;\n  }\n\n  h6 {\n    font-size: 12px;\n  }\n\n  code, pre {\n    min-width: 320px;\n    max-width: 480px;\n    font-size: 11px;\n  }\n\n}"
cmt = "/*Slate Theme for Github Pagesby Jason Costello, @jsncostello lorem Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmodtempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam,quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodoconsequat. Duis aute irure dolor in reprehenderit in voluptate velit essecillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat nonproident, sunt in culpa qui officia deserunt mollit anim id est laborum.*/"
css_comment = "/* whats goin on */"
css_simple = "@media screen and (max-width: 480px) {html,body,p,input[   type=text]{ color:red; background-image:url(  './image.png' );}/* something */.asasd{text-decoration:underline; font-weight:bold;}}"
selector = ".fo, .bar, .asdaklsdal, .890as8989as89d8989, #oiasdlkasjdklasjdlkasjdklasjdklas, .9sd9asldasl"
delim_test = ".something{background-image: url('dat\ttass.jpg');}"

out = open("output.css", "w")
input_stream = open("css.css", "r")

opts = CssFormatOptions()
fmt = CssFormatter(input_stream, out, opts=opts)
fmt.format()